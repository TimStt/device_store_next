(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{4387:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/admin/add",function(){return r(2751)}])},8453:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,r(4370).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2751:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return L}});var o=r(5893),n=r(7294),i=r(2343),s=r.n(i),a=r(3967),l=r.n(a),c=r(6139),_=r.n(c),d=r(9509),u=r(6206),h=r(5007),p=r(2587),m=r(8346),g=r(5862);let x=()=>{let e=(0,h.I0)(),t=(0,h.v9)(m.B);return{onSubmit:r=>{e((0,g.XT)({...r,image:null==t?void 0:t.objectUrl}))}}};var f=r(3763);let v=()=>{let{onSubmit:e}=x(),t=(0,h.I0)(),{formik:r,errorsInputsStates:o,isCountDescription:i,textErrors:s}=(0,f.o)({onSubmit:e,initialValues:{price:0,title:"",description:"",image:""}});return(0,n.useEffect)(()=>{t((0,p.ZJ)({url:"",objectUrl:""}))},[t]),{errorsInputsStates:o,formik:r,isCountDescription:i,textErrors:s}};var b=r(8453),j=r(834),N=r(5066),E=r(343),w=r(1664),Z=r.n(w),y=r(4420),k=()=>{let{errorsInputsStates:e,formik:t,isCountDescription:r,textErrors:n}=v();return(0,o.jsx)(N.Hy,{value:t,children:(0,o.jsxs)("form",{className:_().root,onSubmit:t.handleSubmit,children:[(0,o.jsx)(j.Z,{hasError:e.image,width:300,height:300}),(0,o.jsx)(d.Z,{className:_().root__field,fieldName:"title",type:"text",hasError:e.title,textError:n.title,...t.getFieldProps("title")}),(0,o.jsx)(d.Z,{className:_().root__field,fieldName:"price",type:"number",hasError:e.price,textError:n.price,...t.getFieldProps("price"),children:" "}),(0,o.jsx)(E.Z,{className:_().root__field,classNameField:_().root__field_description,hasErrorInput:e.description,textError:n.description,viewSymbol:{maxLength:400,lenght:r},labelElement:(0,o.jsx)("label",{className:_().root__label_description,htmlFor:"description",children:"Описание"}),id:"description",...t.getFieldProps("description")}),(0,o.jsxs)("div",{className:_().root__actions,children:[(0,o.jsx)(Z(),{href:y.H.admin,children:"Назад"}),(0,o.jsx)(u.Z,{textButton:"Добавить",icon:(0,o.jsx)(b.Z,{className:_().root__icon,width:20,height:20})})]})]})})},L=()=>(0,o.jsx)("article",{className:l()(s().root,"container"),children:(0,o.jsx)("div",{className:s().root__blocks,children:(0,o.jsx)(k,{})})})},2355:function(e,t,r){"use strict";var o=r(5893);r(7294);var n=r(5811),i=r.n(n);t.Z=e=>{let{textError:t}=e;return(0,o.jsx)("span",{className:i().errors,children:t})}},834:function(e,t,r){"use strict";r.d(t,{Z:function(){return U}});var o=r(5893),n=r(7294),i=r(9509),s=r(6066),a=r.n(s),l=r(3171);let c=(0,n.forwardRef)((e,t)=>{let{onChangeImage:r,loading:n,hasError:i}=e;return(0,o.jsx)("button",{className:a().root,onClick:r,type:"button",disabled:n||i,title:"Изменить изображение",ref:t,children:n?(0,o.jsxs)(o.Fragment,{children:[" ",(0,o.jsx)("span",{children:"Идет изменение..."}),(0,o.jsx)(l.Z,{size:10,strokeWidth:2})]}):i?"\uD83D\uDE34":"Изменить изображение"})});c.displayName="ButtonChangeImage";var _=r(5066),d=r(5007),u=r(5121);let h=async(e,t)=>{try{t(!0);let r="".concat("http://localhost:3000","/api/image-proxy?url=").concat(encodeURIComponent(e)),{data:o}=await u.Z.get(r,{responseType:"blob"}),n=URL.createObjectURL(o);return{isValid:!0,url:r,objectUrl:n}}catch(t){return{isValid:!1,url:e,objectUrl:""}}finally{t(!1)}};var p=r(2587),m=r(6501);let g=async e=>{let{result:t,dispatch:r}=e;r((0,p.ZJ)({url:t.url,objectUrl:t.objectUrl})),m.ZP.success("Изображение изменено")},x=(e,t)=>setTimeout(()=>{t&&t()},e),f=e=>{let{refButton:t,setFieldError:r}=e;r("image","Неверный URL изображения");let o=t.current;o.setAttribute("disabled","true"),o.setAttribute("disabled","disabled"),o.innerText="\uD83D\uDE34",x(3e3,()=>{o.removeAttribute("disabled"),r("image",""),o.innerText="Изменить изображение"})},v=()=>{let e=(0,d.I0)(),{getFieldProps:t,errors:r,values:o,setFieldError:i}=(0,_.u6)(),s=(0,n.useRef)(new Map),[a,l]=(0,n.useState)(!1),c=(0,n.useRef)(null),[u,p]=(0,n.useState)(!1),m=async t=>{let r;let n=o.image;if(s.current.has(n)?r=s.current.get(n):(r=await h(n,l),s.current.set(n,r)),r.isValid){g({result:r,dispatch:e});return}p(!0)};return(0,n.useEffect)(()=>{u&&(p(!1),f({refButton:c,setFieldError:i}))},[u,i]),{onChangeImage:m,isLoading:a,getFieldProps:t,values:o,errors:r,refButton:c}};var b=r(8326),j=r.n(b),N=r(5675),E=r.n(N),w=r(9516),Z=r.n(w),y=r(3967),k=r.n(y),L=r(8346),I=e=>{let{width:t,height:r,alt:n}=e,i=(0,d.v9)(L.B);return(0,o.jsx)(E(),{className:k()(Z().root),loading:"lazy",width:t,height:r,src:(null==i?void 0:i.objectUrl)||"/placeholder.jpg",alt:n||"not image"})};let T=(0,n.memo)(e=>{let{width:t,height:r,hasError:n}=e,{onChangeImage:s,values:a,errors:l,getFieldProps:_,refButton:d,isLoading:u}=v();return(0,o.jsxs)("div",{className:j().root,children:[(0,o.jsx)(I,{width:t,height:r,alt:a.title}),(0,o.jsxs)("div",{className:j().root__inner,children:[(0,o.jsx)(i.Z,{className:j().root__field,type:"text",hasError:n,textError:l.image,..._("image")}),(0,o.jsx)(c,{onChangeImage:s,loading:u,ref:d,hasError:n})]})]})});T.displayName="ImageEditModal";var U=T},9509:function(e,t,r){"use strict";var o=r(5893),n=r(7364);r(7294);var i=r(1467),s=r(3967),a=r.n(s),l=r(6903),c=r.n(l),_=r(2355);t.Z=e=>{let{className:t,fieldName:r,children:s,hasError:l,textError:d,textarea:u,...h}=e;return console.log("rerender "+r),(0,o.jsxs)(n.Z,{className:c().root,hasErrorInput:l,labelElement:r&&(0,o.jsx)("label",{className:c().root__label,htmlFor:r,children:(0,i.I)("ru",r)}),classnameBlock:a()(t,c().root__block,{[c().invalid]:l}),id:r,...h,children:[" ",s,l&&(0,o.jsx)(_.Z,{textError:d})]})}},7364:function(e,t,r){"use strict";var o=r(5893),n=r(7294),i=r(3967),s=r.n(i),a=r(7484),l=r.n(a);let c=(0,n.forwardRef)((e,t)=>{let{children:r,classnameBlock:n,classnameInput:i,icon:a,className:c,labelElement:_,hasErrorInput:d,classNameInnerBlock:u,...h}=e;return(0,o.jsxs)("div",{className:s()(l().root,n,{[l().invalid]:d,[l().iconNone]:!a}),children:[a?(0,o.jsxs)("div",{className:s()(l().root__inner,u),children:[_,(0,o.jsx)("input",{className:c,ref:t,...h}),a]}):(0,o.jsxs)(o.Fragment,{children:[_,(0,o.jsx)("input",{ref:t,...h})]}),r]})});c.displayName="InputGroup",t.Z=c},6206:function(e,t,r){"use strict";var o=r(5893);r(7294);var n=r(5007),i=r(6664),s=r.n(i),a=r(2257),l=r(3171);t.Z=e=>{let{textButton:t,icon:r}=e,i=(0,n.v9)(a.R7);return(0,o.jsx)("button",{className:s().root,type:"submit",disabled:i,title:t,children:i?(0,o.jsx)(l.Z,{size:15}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:t}),r]})})}},2257:function(e,t,r){"use strict";r.d(t,{Mg:function(){return i},R7:function(){return n},SV:function(){return o},um:function(){return s}});let o=e=>e.productsActions.deleteLoading,n=e=>e.productsActions.changeLoading,i=e=>e.productsActions.getLoading,s=e=>e.productsActions.product},8346:function(e,t,r){"use strict";r.d(t,{B:function(){return o}});let o=e=>e.changeDevice.changeImage},3763:function(e,t,r){"use strict";r.d(t,{o:function(){return s}});let o=e=>/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e);var n=e=>{let t={},{price:r,description:n,image:i}=e;return(null==n?void 0:n.length)>400&&(t.description="Описание не должно превышать 400 символов"),(null==n?void 0:n.length)<10&&(t.description="Описание должно быть не менее 10 символов"),Object.entries(e).forEach(e=>{let[r,o]=e;o||(t={...t,[r]:"Обязательное поле"})}),o(i)||(t.image="Неверный формат ссылки"),Number(r)||(t.price="Цена должна быть числовым значением"),t},i=r(5066);let s=e=>{var t;let{onSubmit:r,initialValues:o}=e,s=(0,i.TA)({initialValues:o,validate:n,onSubmit:r}),{errors:a,touched:l,values:c}=s,_=null===(t=c.description)||void 0===t?void 0:t.length;return{formik:s,errorsInputsStates:{image:!!a.image&&!!l.image,title:!!a.title&&!!l.title,description:!!a.description&&!!l.description,price:!!a.price&&!!l.price},isCountDescription:_,textErrors:a}}},3171:function(e,t,r){"use strict";var o=r(5893),n=r(714),i=r.n(n),s=r(3967),a=r.n(s);t.Z=e=>{let{size:t,strokeWidth:r=6,className:n}=e,s=t/2;return(0,o.jsx)("svg",{className:a()(i().root,n),viewBox:"0 0 ".concat(t," ").concat(t),xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:"transparent",children:(0,o.jsx)("circle",{className:i().root__path,stroke:"inherit",strokeWidth:r,strokeLinecap:"round",cx:s,cy:s,r:s})})}},343:function(e,t,r){"use strict";var o=r(5893);r(7294);var n=r(3394),i=r.n(n),s=r(3967),a=r.n(s),l=r(2355);t.Z=e=>{let{viewSymbol:t,classNameMaxLength:r,className:n,labelElement:s,hasErrorInput:c,classNameField:_,children:d,textError:u,...h}=e;return(0,o.jsxs)("div",{className:a()(i().root,n),children:[s,(0,o.jsxs)("div",{className:i().root__inner,children:[(0,o.jsx)("textarea",{className:a()(i().root__field,_,{[i().invalid]:c}),maxLength:null==t?void 0:t.maxLength,...h}),(null==t?void 0:t.maxLength)&&(0,o.jsxs)("span",{className:a()(i().root__maxLength,r),children:[t.lenght," / ",t.maxLength]})]}),d,c&&(0,o.jsx)(l.Z,{textError:u})]})}},1467:function(e,t,r){"use strict";r.d(t,{I:function(){return n}});let o={ru:{title:"Название",price:"Цена",image:"Изображение",description:"Описание",username:"Имя пользователя",email:"Электронная почта",phone:"Телефон"},en:{title:"Title",price:"Price",image:"Image",description:"Description",username:"Username",email:"Email",phone:"Phone"}},n=(e,t)=>o[e][t]},5811:function(e){e.exports={errors:"_errorAuth_errors__nQUrt"}},8326:function(e){e.exports={root:"image-edit_root__UsgPT",root__inner:"image-edit_root__inner__HSqxA",root__field:"image-edit_root__field__35ADz"}},6066:function(e){e.exports={root:"button-change-image_root__EmMY4"}},9516:function(e){e.exports={root:"image-change_root__S79tJ"}},6903:function(e){e.exports={root__block:"input-change_root__block___0YYg",root__label:"input-change_root__label__uds6u"}},7484:function(e){e.exports={root:"input-group_root__bCqPx",iconNone:"input-group_iconNone__c0tTw",invalid:"input-group_invalid__P1cn5"}},6664:function(e){e.exports={root:"submit-change_root__M_1X2"}},2343:function(e){e.exports={root:"card-change_root__Te6ci",root__blocks:"card-change_root__blocks__2cR8_",root__return:"card-change_root__return__XVeEz"}},6139:function(e){e.exports={root:"form-change-device_root__FrLx3",root__image_block:"form-change-device_root__image_block__Zib0E",root__label_description:"form-change-device_root__label_description__Res8f",root__field:"form-change-device_root__field__kd6rK",description:"form-change-device_description__ywMVX",root__field_description:"form-change-device_root__field_description__TfWvx",root__actions:"form-change-device_root__actions__silXs"}},714:function(e){e.exports={root:"spinner_root__bTm2b",rotator:"spinner_rotator__JW5KF",root__path:"spinner_root__path__Hl9xr",dash:"spinner_dash__k9eFl",colors:"spinner_colors__pVAZV"}},3394:function(e){e.exports={root:"textarea-ui_root__dhMJH",root__field:"textarea-ui_root__field__fh539",invalid:"textarea-ui_invalid__MD_qS",root__inner:"textarea-ui_root__inner__mgLl6",root__maxLength:"textarea-ui_root__maxLength__eD67l"}}},function(e){e.O(0,[66,888,774,179],function(){return e(e.s=4387)}),_N_E=e.O()}]);