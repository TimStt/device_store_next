(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[301],{2291:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/admin/list/product",function(){return r(5612)}])},5612:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var o=r(5893),i=r(7294),n=r(8596),s=r.n(n),a=r(3967),l=r.n(a),c=r(585),_=r.n(c),d=r(9509),u=r(6206),p=r(2257),h=r(5007),m=r(2587),g=r(8346),x=r(5862);let f=()=>{let e=(0,h.v9)(p.um);console.log(e);let t=(0,h.I0)(),r=(0,h.v9)(g.B);return{choosenDevice:e,onSubmit:o=>{t((0,x.y5)({...o,id:null==e?void 0:e.id,image:null==r?void 0:r.objectUrl}))}}};var v=r(3763);let j=()=>{let e=(0,h.v9)(p.um),{onSubmit:t}=f(),r=(0,h.I0)(),o={price:(null==e?void 0:e.price)||0,title:(null==e?void 0:e.title)||"",description:(null==e?void 0:e.description)||"",image:(null==e?void 0:e.image)||""},{formik:n,errorsInputsStates:s,isCountDescription:a,textErrors:l}=(0,v.o)({onSubmit:t,initialValues:o});return(0,i.useEffect)(()=>{console.log("choosenDevice"),e&&n.values.description!==e.description&&(console.log("if choosenDevice"),n.setFieldValue("price",e.price||0),n.setFieldValue("title",e.title),n.setFieldValue("description",e.description),n.setFieldValue("image",e.image),r((0,m.ZJ)({url:e.image,objectUrl:e.image})))},[e,n,r]),{choosenDevice:e,errorsInputsStates:s,formik:n,isCountDescription:a,textErrors:l}},b=(0,r(4370).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);var N=r(834),E=r(5066),w=r(343),y=r(1664),Z=r.n(y),k=r(4420),L=r(9332),S=()=>{let{errorsInputsStates:e,formik:t,isCountDescription:r,textErrors:i}=j(),n=(0,L.useSearchParams)(),s=new URLSearchParams(null==n?void 0:n.toString()).get("page");return(0,o.jsx)(E.Hy,{value:t,children:(0,o.jsxs)("form",{className:_().root,onSubmit:t.handleSubmit,children:[(0,o.jsx)(N.Z,{hasError:e.image,width:300,height:300}),(0,o.jsx)(d.Z,{className:_().root__field,fieldName:"title",type:"text",hasError:e.title,textError:i.title,...t.getFieldProps("title")}),(0,o.jsx)(d.Z,{className:_().root__field,fieldName:"price",type:"number",hasError:e.price,textError:i.price,...t.getFieldProps("price"),children:" "}),(0,o.jsx)(w.Z,{className:_().root__field,classNameField:_().root__field_description,hasErrorInput:e.description,textError:i.description,viewSymbol:{maxLength:400,lenght:r},labelElement:(0,o.jsx)("label",{className:_().root__label_description,htmlFor:"description",children:"Описание"}),id:"description",...t.getFieldProps("description")}),(0,o.jsxs)("div",{className:_().root__actions,children:[(0,o.jsx)(Z(),{href:k.H.adminList(s),children:"Назад"}),(0,o.jsx)(u.Z,{textButton:"Изменить",icon:(0,o.jsx)(b,{className:_().root__icon,width:20,height:20})})]})]})})};let I=()=>{let e=(0,h.I0)(),t=(0,L.useSearchParams)(),r=new URLSearchParams(null==t?void 0:t.toString()).get("id");(0,i.useEffect)(()=>{r&&e((0,x.gT)(r))},[e,r])};var F=()=>(I(),(0,o.jsx)("article",{className:l()(s().root,"container"),children:(0,o.jsx)("div",{className:s().root__blocks,children:(0,o.jsx)(S,{})})}))},2355:function(e,t,r){"use strict";var o=r(5893);r(7294);var i=r(5811),n=r.n(i);t.Z=e=>{let{textError:t}=e;return(0,o.jsx)("span",{className:n().errors,children:t})}},834:function(e,t,r){"use strict";r.d(t,{Z:function(){return F}});var o=r(5893),i=r(7294),n=r(9509),s=r(6066),a=r.n(s),l=r(3171);let c=(0,i.forwardRef)((e,t)=>{let{onChangeImage:r,loading:i,hasError:n}=e;return(0,o.jsx)("button",{className:a().root,onClick:r,type:"button",disabled:i||n,title:"Изменить изображение",ref:t,children:i?(0,o.jsxs)(o.Fragment,{children:[" ",(0,o.jsx)("span",{children:"Идет изменение..."}),(0,o.jsx)(l.Z,{size:10,strokeWidth:2})]}):n?"\uD83D\uDE34":"Изменить изображение"})});c.displayName="ButtonChangeImage";var _=r(5066),d=r(5007),u=r(5121);let p=async(e,t)=>{try{t(!0);let r="".concat("http://localhost:3000","/api/image-proxy?url=").concat(encodeURIComponent(e)),{data:o}=await u.Z.get(r,{responseType:"blob"}),i=URL.createObjectURL(o);return{isValid:!0,url:r,objectUrl:i}}catch(t){return{isValid:!1,url:e,objectUrl:""}}finally{t(!1)}};var h=r(2587),m=r(6501);let g=async e=>{let{result:t,dispatch:r}=e;r((0,h.ZJ)({url:t.url,objectUrl:t.objectUrl})),m.ZP.success("Изображение изменено")},x=(e,t)=>setTimeout(()=>{t&&t()},e),f=e=>{let{refButton:t,setFieldError:r}=e;r("image","Неверный URL изображения");let o=t.current;o.setAttribute("disabled","true"),o.setAttribute("disabled","disabled"),o.innerText="\uD83D\uDE34",x(3e3,()=>{o.removeAttribute("disabled"),r("image",""),o.innerText="Изменить изображение"})},v=()=>{let e=(0,d.I0)(),{getFieldProps:t,errors:r,values:o,setFieldError:n}=(0,_.u6)(),s=(0,i.useRef)(new Map),[a,l]=(0,i.useState)(!1),c=(0,i.useRef)(null),[u,h]=(0,i.useState)(!1),m=async t=>{let r;let i=o.image;if(s.current.has(i)?r=s.current.get(i):(r=await p(i,l),s.current.set(i,r)),r.isValid){g({result:r,dispatch:e});return}h(!0)};return(0,i.useEffect)(()=>{u&&(h(!1),f({refButton:c,setFieldError:n}))},[u,n]),{onChangeImage:m,isLoading:a,getFieldProps:t,values:o,errors:r,refButton:c}};var j=r(8326),b=r.n(j),N=r(5675),E=r.n(N),w=r(9516),y=r.n(w),Z=r(3967),k=r.n(Z),L=r(8346),S=e=>{let{width:t,height:r,alt:i}=e,n=(0,d.v9)(L.B);return(0,o.jsx)(E(),{className:k()(y().root),loading:"lazy",width:t,height:r,src:(null==n?void 0:n.objectUrl)||"/placeholder.jpg",alt:i||"not image"})};let I=(0,i.memo)(e=>{let{width:t,height:r,hasError:i}=e,{onChangeImage:s,values:a,errors:l,getFieldProps:_,refButton:d,isLoading:u}=v();return(0,o.jsxs)("div",{className:b().root,children:[(0,o.jsx)(S,{width:t,height:r,alt:a.title}),(0,o.jsxs)("div",{className:b().root__inner,children:[(0,o.jsx)(n.Z,{className:b().root__field,type:"text",hasError:i,textError:l.image,..._("image")}),(0,o.jsx)(c,{onChangeImage:s,loading:u,ref:d,hasError:i})]})]})});I.displayName="ImageEditModal";var F=I},9509:function(e,t,r){"use strict";var o=r(5893),i=r(7364);r(7294);var n=r(1467),s=r(3967),a=r.n(s),l=r(6903),c=r.n(l),_=r(2355);t.Z=e=>{let{className:t,fieldName:r,children:s,hasError:l,textError:d,textarea:u,...p}=e;return console.log("rerender "+r),(0,o.jsxs)(i.Z,{className:c().root,hasErrorInput:l,labelElement:r&&(0,o.jsx)("label",{className:c().root__label,htmlFor:r,children:(0,n.I)("ru",r)}),classnameBlock:a()(t,c().root__block,{[c().invalid]:l}),id:r,...p,children:[" ",s,l&&(0,o.jsx)(_.Z,{textError:d})]})}},7364:function(e,t,r){"use strict";var o=r(5893),i=r(7294),n=r(3967),s=r.n(n),a=r(7484),l=r.n(a);let c=(0,i.forwardRef)((e,t)=>{let{children:r,classnameBlock:i,classnameInput:n,icon:a,className:c,labelElement:_,hasErrorInput:d,classNameInnerBlock:u,...p}=e;return(0,o.jsxs)("div",{className:s()(l().root,i,{[l().invalid]:d,[l().iconNone]:!a}),children:[a?(0,o.jsxs)("div",{className:s()(l().root__inner,u),children:[_,(0,o.jsx)("input",{className:c,ref:t,...p}),a]}):(0,o.jsxs)(o.Fragment,{children:[_,(0,o.jsx)("input",{ref:t,...p})]}),r]})});c.displayName="InputGroup",t.Z=c},6206:function(e,t,r){"use strict";var o=r(5893);r(7294);var i=r(5007),n=r(6664),s=r.n(n),a=r(2257),l=r(3171);t.Z=e=>{let{textButton:t,icon:r}=e,n=(0,i.v9)(a.R7);return(0,o.jsx)("button",{className:s().root,type:"submit",disabled:n,title:t,children:n?(0,o.jsx)(l.Z,{size:15}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:t}),r]})})}},2257:function(e,t,r){"use strict";r.d(t,{Mg:function(){return n},R7:function(){return i},SV:function(){return o},um:function(){return s}});let o=e=>e.productsActions.deleteLoading,i=e=>e.productsActions.changeLoading,n=e=>e.productsActions.getLoading,s=e=>e.productsActions.product},8346:function(e,t,r){"use strict";r.d(t,{B:function(){return o}});let o=e=>e.changeDevice.changeImage},3763:function(e,t,r){"use strict";r.d(t,{o:function(){return s}});let o=e=>/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e);var i=e=>{let t={},{price:r,description:i,image:n}=e;return(null==i?void 0:i.length)>400&&(t.description="Описание не должно превышать 400 символов"),(null==i?void 0:i.length)<10&&(t.description="Описание должно быть не менее 10 символов"),Object.entries(e).forEach(e=>{let[r,o]=e;o||(t={...t,[r]:"Обязательное поле"})}),o(n)||(t.image="Неверный формат ссылки"),Number(r)||(t.price="Цена должна быть числовым значением"),t},n=r(5066);let s=e=>{var t;let{onSubmit:r,initialValues:o}=e,s=(0,n.TA)({initialValues:o,validate:i,onSubmit:r}),{errors:a,touched:l,values:c}=s,_=null===(t=c.description)||void 0===t?void 0:t.length;return{formik:s,errorsInputsStates:{image:!!a.image&&!!l.image,title:!!a.title&&!!l.title,description:!!a.description&&!!l.description,price:!!a.price&&!!l.price},isCountDescription:_,textErrors:a}}},3171:function(e,t,r){"use strict";var o=r(5893),i=r(714),n=r.n(i),s=r(3967),a=r.n(s);t.Z=e=>{let{size:t,strokeWidth:r=6,className:i}=e,s=t/2;return(0,o.jsx)("svg",{className:a()(n().root,i),viewBox:"0 0 ".concat(t," ").concat(t),xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:"transparent",children:(0,o.jsx)("circle",{className:n().root__path,stroke:"inherit",strokeWidth:r,strokeLinecap:"round",cx:s,cy:s,r:s})})}},343:function(e,t,r){"use strict";var o=r(5893);r(7294);var i=r(3394),n=r.n(i),s=r(3967),a=r.n(s),l=r(2355);t.Z=e=>{let{viewSymbol:t,classNameMaxLength:r,className:i,labelElement:s,hasErrorInput:c,classNameField:_,children:d,textError:u,...p}=e;return(0,o.jsxs)("div",{className:a()(n().root,i),children:[s,(0,o.jsxs)("div",{className:n().root__inner,children:[(0,o.jsx)("textarea",{className:a()(n().root__field,_,{[n().invalid]:c}),maxLength:null==t?void 0:t.maxLength,...p}),(null==t?void 0:t.maxLength)&&(0,o.jsxs)("span",{className:a()(n().root__maxLength,r),children:[t.lenght," / ",t.maxLength]})]}),d,c&&(0,o.jsx)(l.Z,{textError:u})]})}},1467:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});let o={ru:{title:"Название",price:"Цена",image:"Изображение",description:"Описание",username:"Имя пользователя",email:"Электронная почта",phone:"Телефон"},en:{title:"Title",price:"Price",image:"Image",description:"Description",username:"Username",email:"Email",phone:"Phone"}},i=(e,t)=>o[e][t]},5811:function(e){e.exports={errors:"_errorAuth_errors__nQUrt"}},8326:function(e){e.exports={root:"image-edit_root__UsgPT",root__inner:"image-edit_root__inner__HSqxA",root__field:"image-edit_root__field__35ADz"}},6066:function(e){e.exports={root:"button-change-image_root__EmMY4"}},9516:function(e){e.exports={root:"image-change_root__S79tJ"}},6903:function(e){e.exports={root__block:"input-change_root__block___0YYg",root__label:"input-change_root__label__uds6u"}},7484:function(e){e.exports={root:"input-group_root__bCqPx",iconNone:"input-group_iconNone__c0tTw",invalid:"input-group_invalid__P1cn5"}},6664:function(e){e.exports={root:"submit-change_root__M_1X2"}},8596:function(e){e.exports={root:"card-change_root__3sq91",root__blocks:"card-change_root__blocks__Rzc1a",root__return:"card-change_root__return__pzt8j"}},585:function(e){e.exports={root:"form-change-device_root__B7B9h",root__image_block:"form-change-device_root__image_block___hZX8",root__label_description:"form-change-device_root__label_description__X9xEg",root__field:"form-change-device_root__field__HVkvh",description:"form-change-device_description__rgeNB",root__field_description:"form-change-device_root__field_description__NgO5V",root__actions:"form-change-device_root__actions__ppdaj"}},714:function(e){e.exports={root:"spinner_root__bTm2b",rotator:"spinner_rotator__JW5KF",root__path:"spinner_root__path__Hl9xr",dash:"spinner_dash__k9eFl",colors:"spinner_colors__pVAZV"}},3394:function(e){e.exports={root:"textarea-ui_root__dhMJH",root__field:"textarea-ui_root__field__fh539",invalid:"textarea-ui_invalid__MD_qS",root__inner:"textarea-ui_root__inner__mgLl6",root__maxLength:"textarea-ui_root__maxLength__eD67l"}}},function(e){e.O(0,[66,888,774,179],function(){return e(e.s=2291)}),_N_E=e.O()}]);